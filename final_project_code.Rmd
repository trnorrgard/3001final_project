---
title: "final_project"
author: "Teagan Norrgard, trn8cwf"
date: "11/24/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r warning=FALSE, include=FALSE, echo=FALSE}
library(dplyr)
library(tidyverse)
```


###First we read in our dataset.

Our dataset was obtained from Kaggle but the data itself was sourced from Inside Airbnb
The first thing we did was read in our data.
```{r}
boston <- read.csv("/Users/teagannorrgard/3001final_project/Boston_Airbnb_copy.csv")
head(boston, 5)
```


### Next we got to cleaning our data. 
This included sub-setting columns we thought would make for interesting predictions, renaming columns so that they would be easier to call, and making 'price' and 'cleaning_fee' numeric variables.
```{r}
boston <- boston%>%
  select(c("name","neighbourhood_cleansed","latitude", "longitude", "room_type", 
           "accommodates", "price", "cleaning_fee", "minimum_nights", "number_of_reviews",
           "review_scores_rating","host_response_rate", "host_acceptance_rate", 
           "host_is_superhost"))

boston <-  boston%>%
  rename(superhost = host_is_superhost, neighborhood = neighbourhood_cleansed)

boston$price = as.numeric(gsub("\\$", "", boston$price))
boston$cleaning_fee = as.numeric(gsub("\\$", "", boston$cleaning_fee))
```


### Then we made some basic exploration tables and visualizations.
```{r}
## looking at neighborhood counts
## we see here than the most popular neighborhoods are Jamaica Plain, South End, 
## Back Bay, Fenway, Dorchester, and Allston.
table(boston$neighborhood)
```


```{r}
## table of median values of numeric/important columns
## could be interesting to compare to means
bost_med_table <- boston%>%
  group_by(neighborhood)%>%
  summarise(medianReview = median(review_scores_rating, na.rm=T), medianNumReviews = median(number_of_reviews, na.rm=T),
            medianPrice = median(price, na.rm=T), medianCleanFee = median(cleaning_fee, na.rm=T))

bost_med_table

library(RColorBrewer)

plot <- ggplot(data=bost_med_table, aes(x=neighborhood, y=medianPrice, fill=medianPrice))+
  scale_fill_gradient(low = "dark red", high = "cornflowerblue")+
  geom_bar(stat='identity')+
  theme(axis.text.x = element_text(angle=90))+
  labs(x="Neighborhood", y="Median Price of Airbnb per Night", title="Distribution of Airbnb prices per night over Neighborhoods in Boston")


plot
```


```{r}
## table of number of room type by neighborhood, keep in mind table of neighborhood counts
boston%>%
  group_by(neighborhood)%>%
  select(room_type)%>%
  table()
```


```{r}
boston_top100 <- boston%>%
  arrange(desc(price))

## we see here that the top 100 most expensive places are pretty evenly distributed over neighborhoods,
## Back Bay has the highest number with 17 but doesn't seem so high that it is an outlier.
## this also makes sense because Back Bay was one of the most popular neighborhoods in the first place
head(boston_top100, 100)%>%
  select(neighborhood)%>%
  table()

```






